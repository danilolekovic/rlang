# Rlang : a (subset of) Ruby to WebAssembly compiler

Rlang is meant to create fast and uncluttered [WebAssembly](https://webassembly.org) code from the comfort of the Ruby language.

Rlang is not a new language and it is not intended to be a general purpose languange. It is actually two things: a supported subset of the Ruby language and a compiler ("translator" would actually be more appropriate) transforming this Ruby subset in a valid and fully runnable WebAssembly module.

Rlang can be seen as a foundational language that can help you quickly develop and debug high performance WebAssembly modules. For the rationale behind the creation of Rlang see below.

What you'll find in the current version is a first implementation of Rlang. It will improve over time, with more facilities and probably more Ruby features but always with the goal to generate crisp and uncluttered WAT code.

## Dependencies

* **WABT toolit**: the rlang compiler can generate both WebAssembly source code (WAT file) and WebAssembly bytecode (WASM file). To generate WASM bytecode the rlang compiler uses wat2wasm. This utility is part of the [WABT toolkit](https://github.com/WebAssembly/wabt)
* **wasmer runtime** (optional): [Wasmer](https://wasmer.io/) is a fast WebAssembly runtime. You'll need it if you want to run the test suite from the source repo. You can also use it to run the compiled WASM code generated by the rlang compiler. You can get Wasmer at  [wasmer.io](https://wasmer.io/)


## Installing Rlang
Rlang is not yet published as a gem. This will come soon. In the meantime, clone the Rlang git repo and run the following command:


```
$ gem build rlang.gemspec
$ gem install --local rlang-0.1.0.gem
```

To check that the installation went well, run `rlang --help` and see if the help message displays correctly

## The Rlang language
Ruby features supported by Rlang are detailed in the [Rlang Manual](https://github.com/ljulliar/rlang/blob/master/docs/RlangLanguage.md)

You can also look at the rlang test suite in [test/rlang_files](https://github.com/ljulliar/rlang/blob/master/test/rlang_files/) to get a flavor of the subset of Ruby currently supported.

## rlang compiler
The Rlang compiler can be invoked through the `rlang` command. See the [Rlang Compiler Documentation](https://github.com/ljulliar/rlang/blob/master/docs/RlangCompiler.md) for more details about th command line options.


## rlang simulator
**COMING SOON**
One of the benefits of Rlang being a subset of the Ruby language is that you can actually run, test and debug your Rlang code as you would for normal Ruby code. This can be a big boost for your productivity.

## Why Rlang?
This project was created out of the need to develop a Virtual Machine written in WebAssembly capable of interpreting the [Rubinius](https://github.com/rubinius/rubinius) bytecode. And yes, ultimately running a native Ruby VM in a browser :-)

After a first proof of concept written directly by hand in WebAssembly (WAT code) it became clear that writing a full fledged VM directly in WebAssembly was going to be tedious, complex and un-necessarily painful.

Sure I could have written this VM in any of the language that can already be compiled directly to WebAssembly (C, C++, Rust, Go,...) but being fond of Ruby since 2000 I decided that I would go for a compiler (Rlang) capable of transforming a subset of the Ruby language directly into WebAssembly with a minimum overhead. So in a nutshell: the goal of Rlang is to let you develop efficient WebAssembly code with a reasonably high level of abstraction while keeping the generated WebAssembly code straightforward.

The name **Rlang** itself is also a tribute to [Slang](http://wiki.squeak.org/squeak/slang), a subset of the Smalltalk language that can directly translate to C. It was [created in 1995] to bootstrap the development of the Squeak VM, an open-source Smalltalk programming system. I highly encourage anyone interested in the history and the technology of virtual machines to read the both the [Back to the future article](http://www.vpri.org/pdf/tr1997001_backto.pdf) and the legendary [Blue Book](http://stephane.ducasse.free.fr/FreeBooks/BlueBook/Bluebook.pdf). I would actually go as far as saying that you don't really know what (virtual) machines are until you have read this book :-)

## Credits
A big thank to [@whitequark](https://github.com/whitequark) for a fantastic [Ruby parser](https://github.com/whitequark/parser)
